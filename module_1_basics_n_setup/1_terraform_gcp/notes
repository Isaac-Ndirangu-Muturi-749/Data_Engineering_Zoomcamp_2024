HashiCorp Terraform is an infrastructure as code tool that lets you
define both cloud and on-prem resources in human-readable
configuration files that you can version, reuse, and share. You can then
use a consistent workflow to provision and manage all of your
infrastructure throughout its lifecycle.


Why Terraform?

Simplicity in keeping track of infrastructure
Easier collaboration
Reproducibility
Ensure resources are removed


What Terraform is not-

· Does not manage and update code on infrastructure
. Does not give you the ability to change immutable resources
. Not used to manage resources not defined in your terraform files


What is Terraform?
· Infrastructure as code

What are providers?

Code that allows terraform to communicate to manage resources on
. AWS
· Azure
· GCP
· Kubernetes
· VSphere
· Alibaba Cloud
· Oracle Cloud Infrastructure
· Active Directory


Key Terraform Commands

. Init - Get me the providers I need

· Plan - What am I about to do?

. Apply - Do what is in the tf files

. Destroy - Remove everything defined in the tf files


wget -O- https://apt.releases.hashicorp.com/gpg | sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg
echo "deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/hashicorp.list
sudo apt update && sudo apt install terraform


export GOOGLE_CREDENTIALS='/home/ndirangu749/ZOOMCAMP/Data_Engineering_Zoomcamp_2024/week_2/terrademo/keys/my-creds.json'


terraform init


resource "google_storage_bucket" "auto-expire" {
  name          = "auto-expiring-bucket"
  location      = "US"
  force_destroy = true

  lifecycle_rule {
    condition {
      age = 3
    }
    action {
      type = "Delete"
    }
  }

  lifecycle_rule {
    condition {
      age = 1
    }
    action {
      type = "AbortIncompleteMultipartUpload"
    }
  }
}


variable "bq_dataset_name" {
    Idescription = "My BigQuery Dataset Name"
    default = "demo_dataset"
}

variable "gcs_bucket_name" {
    description = "My Storage Bucket Name"
    default = "direct-disk-412820-terra-bucket"
}

variable "gcs_storage_class" {
    description = "Bucket Storage Class"
    default = "STANDARD"
}


unset GOOGLE_CREDENTIALS


ssh-keygen -t rsa -f gcloud -C ndirangu749 -b 2048


ssh -i ~/.ssh/gcloud ndirangu749@35.184.39.158


wget https://repo.anaconda.com/archive/Anaconda3-2023.09-0-Linux-x86_64.sh


sudo apt-get install docker.io


\\wsl.localhost\Ubuntu-20.04\home\ndirangu749\.ssh\config


https://github.com/Isaac-Ndirangu-Muturi-749/Data_Engineering_Zoomcamp_2024.git


https://github.com/sindresorhus/guides/blob/main/docker-without-sudo.md


curl -SL https://github.com/docker/compose/releases/download/v2.24.5/docker-compose-linux-x86_64 -o /usr/local/bin/docker-compose


sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose


wget https://github.com/docker/compose/releases/download/v2.24.3/docker-compose-linux-x86_64 -O docker-compose


pgcli -h localhost -U root -d ny_taxi


export GOOGLE_APPLICATION_CREDENTIALS=~/.gc/direct-disk-412820-2671b48097be.json

gcloud auth activate-service-account --key-file=$GOOGLE_APPLICATION_CREDENTIALS


docker build -t taxi_ingest:v001 .

ny_taxi_postgres_data

chmod o+rwx ny_taxi_postgres_data
